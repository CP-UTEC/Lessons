<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Clase 04: Brute Force I</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<script src="site_libs/elevate-section-attrs-2.0/elevate-section-attrs.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CP UTEC</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 1</li>
    <li>
      <a href="class-01.html">The Art of Thinking</a>
    </li>
    <li>
      <a href="class-02.html">Think Big</a>
    </li>
    <li class="dropdown-header">Week 2</li>
    <li>
      <a href="class-03.html">Don't reinvent the wheel!</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="daily-problem.html">Daily Problem</a>
</li>
<li>
  <a href="gallery.html">Gallery</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Clase 04: Brute Force I</h1>
<h4 class="date">13-01-2020</h4>

</div>


<blockquote>
<p>“Union make Force”</p>
</blockquote>
<div class="topic">
Problem Solving Paradigms
</div>
<p>A programming paradigm is a way to solve problems. The four problem solving paradigms commonly used in programming contests are:</p>
<div class="center-image">
<p><img src="images/class-04/programming-paradigms.png" /></p>
</div>
<p>Complete search is a general method that can be used to solve almost any algorithm problem. It basically try to generate all possible solutions to a problem in order to do something with them (count number of elements, find a particular solution with one property, etc).</p>
<p>You can find complete search solution in two ways: iterative and recursive. When it is iterative it may be a single loop, two loops, three or more loops, using two pointers, etc. When it is recursive it can be a simple recursive function, it can be a recursive function that search different states with trial and error (backtracking), it may have some kind of prunning in order to not visit every state, etc.</p>
<p>When solving complete search solutions you will follow some combination of these structures to solve problems.</p>
<p>When you find complete search in a iterative way it is called a <code>brute force</code> solution. In the next 4 classes we will study more about this kind of solutions. Moreover, mastering this paradigm will help you to understand easily the other ones.</p>
<div class="topic">
Pythagorean triples
</div>
<p>Lets start this paradigm solving a simple problem.</p>
<p>A pythagorean triple is a triplet (x,y,z) that satisfies the equation <span class="math inline">\(x^2 + y^2 = z^2\)</span>.</p>
<p><strong>Problem:</strong> You will receive an integer <span class="math inline">\(n\)</span>. Find the number of pythagorean triples such that <span class="math inline">\(1 \leq x, y, z \leq n\)</span>.</p>
<p><span class="math display">\[1 \leq n \leq 10^3\]</span></p>
<div id="first-solution" class="section level3">
<h3>First solution</h3>
<p>We can fix <span class="math inline">\(x, y, z\)</span> using three loops and verify if the equation holds in <span class="math inline">\(O(n^3)\)</span>.</p>
<pre class="cpp"><code>int solution1 (int n) {
  int cnt = 0;
  for (int x = 1; x &lt;= n; x++) {
    for (int y = 1; y &lt;= n; y++) {
      for (int z = 1; z &lt;= n; z++) {
        if (x * x + y * y == z * z) {
          cnt++;
        }
      }
    }
  }
  return cnt;
}</code></pre>
<p>We can fix <span class="math inline">\(x, y\)</span> and determine if <span class="math inline">\(\exists \, 1 \leq z \leq n\)</span> that holds the equation in <span class="math inline">\(O(n^2)\)</span>.</p>
</div>
<div id="second-solution" class="section level3">
<h3>Second solution</h3>
<pre class="cpp"><code>int solution2 (int n) {
  vector &lt;bool&gt; is_sq(n * n + 1, false);
  for (int z = 1; z &lt;= n; z++) {
    is_sq[z * z] = true;
  }
  int cnt = 0;
  for (int x = 1; x &lt;= n; x++) {
    for (int y = 1; y &lt;= n; y++) {
      if (x * x + y * y &lt;= n * n and is_sq[x * x + y * y]) {
        cnt++;
      }
    }
  }
  return cnt;
}</code></pre>
</div>
<div id="third-solution" class="section level3">
<h3>Third solution</h3>
<p>If <span class="math inline">\((x, y, z)\)</span> is a pythagorean triple, then <span class="math inline">\((kx, ky, kz), k \in \mathbb{N}\)</span> is also a pythagorean triple.</p>
<p>So, if we find <span class="math inline">\((x, y, z) \mid gcd(x, y, z) = 1\)</span>, then the number of triples <span class="math inline">\((kx, ky, kz) \mid 1 \leq kx, ky, kz \leq n\)</span> is <span class="math inline">\(\min(\lfloor n / x \rfloor, \lfloor n / y \rfloor, \lfloor n / z \rfloor )\)</span>.</p>
<p>If <span class="math inline">\((x, y, z)\)</span> is a pythagorean triple and <span class="math inline">\(gcd(x, y, z) = 1\)</span>, then <span class="math inline">\((x, y, z)\)</span> is called a primite pythagorean triple.</p>
<p>And there is a property (Euclid’s formula) that says that every primite pythagorean triple can be represented by a pair <span class="math inline">\((a, b) \mid 0 &lt; b &lt; a \land gcd(a, b) = 1 \land a\)</span> and <span class="math inline">\(b\)</span> are not both odds in the following way:</p>
<p><span class="math display">\[x = a^2 - b^2\]</span> <span class="math display">\[y = 2 * a * b\]</span> <span class="math display">\[z = a * a + b * b\]</span></p>
<p>Then we can generate primites <span class="math inline">\((x, y, z) \land (y, x, z)\)</span> and count how many of their multiples hold the condition of the problem in <span class="math inline">\(O(n^2 \log n)\)</span>.</p>
<p><strong>Note:</strong></p>
<p><span class="math inline">\(gcd(a, b) =\)</span> greatest common divisor of <span class="math inline">\(a\)</span> and <span class="math inline">\(b = \max(d \mid d | a \land d | b)\)</span></p>
<pre class="cpp"><code>int solution3 (int n) {
  int cnt = 0;
  for (int a = 1; a &lt; n / 2; a++) {
    for (int b = 1; b &lt; a; b++) {
      if (__gcd(a, b) != 1) continue;
      if (a % 2 and b % 2) continue;
      int x = a * a - b * b;
      int y = 2 * a * b;
      int z = a * a + b * b;
      int add = min({n / x, n / y, n / z});
      cnt += 2 * add;
    }
  }
  return cnt;
}</code></pre>
<p><a href="./code/class-04/pythagorean-triple.cpp">Full code</a></p>
<div class="topic">
Primality Test
</div>
<p><strong>Problem:</strong> Given a number <span class="math inline">\(n\)</span>, determine if it is prime or not,</p>
<p><strong>Definition:</strong> A prime number is a natural number that have exactly two divisors. The first prime numbers are <span class="math inline">\(2, 3, 5, 7, 11, 13, \dots\)</span></p>
<div id="first-solution-1" class="section level4">
<h4>First solution</h4>
<p>We can use the given definition and implement a <span class="math inline">\(O(n)\)</span> solution.</p>
<pre class="cpp"><code>bool isPrime1 (int n) {
  int n_div = 0;
  for (int d = 1; d &lt;= n; d++) {
    if (n % d == 0) n_div++;
  }
  return (n_div == 2);
}</code></pre>
</div>
<div id="second-solution-1" class="section level4">
<h4>Second solution</h4>
<p>We notice that if <span class="math inline">\(d | n \to (n / d) | n\)</span>. Moreover: <span class="math display">\[\text{If } d \not = \sqrt{n} \to (d &lt; \sqrt{n} &lt; (n / d)) \lor ((n / d) &lt; \sqrt{n} &lt; d)\]</span></p>
<p>So we can assume <span class="math inline">\(d &lt; (n / d)\)</span> iterate for every <span class="math inline">\(d &lt; \sqrt{n}\)</span> and if <span class="math inline">\(d | n\)</span> count two more divisors (<span class="math inline">\(d, n / d\)</span>) and handle the special case <span class="math inline">\(d = \sqrt{n}\)</span>. In this way we can count the number of divisors of <span class="math inline">\(n\)</span> and check if a number if prime in <span class="math inline">\(O(\sqrt{n})\)</span>.</p>
<pre class="cpp"><code>bool isPrime2 (int n) {
  int n_div = 0;
  for (int d = 1; d * d &lt;= n; d++) {
    if (n % d == 0) {
      n_div++;
      if (n / d != d) n_div++;
    }
  }
  return (n_div == 2);
}</code></pre>
<p><a href="./code/class-04/primality-check.cpp">Full code</a></p>
<div class="topic">
Sieve of Eratosthenes
</div>
<p>We want to solve the same problem of the previous section but now we want to be able to handle multiples queries in a optimal way. Then, we want to store an array where we can get wheter or not a number is prime.</p>
<p>We can use a simple idea to achieve that. We will initiate with an array where every element is true (it will represent if the number is prime or not). Then we will iterate from <span class="math inline">\(2\)</span> to <span class="math inline">\(n\)</span> and every time we find a prime number, we set to false its multiples that are greater than it.</p>
<p>As every prime number have only two divisors (1 and itself), and we are iterating from the number 2, then when we are in the number <span class="math inline">\(i\)</span> in the iteration if <span class="math inline">\(i\)</span> is a prime number it will be set to true, else <span class="math inline">\(\exists \, p\)</span> (prime) <span class="math inline">\(: p &lt; i \land p | i\)</span>, so the array will already be set to false in that position.</p>
<p>We can use this idea and implement an algorithm two obtain such array. The special cases (i.e <span class="math inline">\(n = 0 \lor n = 1\)</span>) can be handle easily. The complexity of this solution is <span class="math inline">\(O(n \log \log n)\)</span>.</p>
<pre class="cpp"><code>vector &lt;bool&gt; sieve (int n) {
  vector &lt;bool&gt; is_prime(n + 1, true);
  is_prime[0] = is_prime[1] = false;
  for (int i = 2; i &lt;= n; i++) {
    if (!is_prime[i]) continue;
    for (int j = 2 * i; j &lt;= n; j += i) {
      is_prime[j] = false;
    }
  }
  return is_prime;
}</code></pre>
<p><a href="./code/class-04/sieve-of-eratosthenes.cpp">Full code</a></p>
<div class="topic">
Finding the number of divisors of a number
</div>
<p>In process…</p>
<div class="topic">
<span class="math inline">\(\sigma_{0}(n) = O(\sqrt[3]{n})\)</span>
</div>
<p>In process..</p>
<div class="topic">
<a href="">Contest</a>
</div>
</div>
</div>

<footer>
  <p>Copyright &copy; 2020 Competitive Programming UTEC</p>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
